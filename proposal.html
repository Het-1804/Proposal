import React, { useState } from "react";
import { View, Text, StyleSheet, TouchableOpacity, TextInput, Image, ScrollView, Alert } from "react-native";
import * as ImagePicker from "expo-image-picker";

export default function App() {
  const [step, setStep] = useState(1);
  const [answers, setAnswers] = useState({
    loveAmt: "",
    comfort: "",
    food: "",
    activity: "",
    memory: "",
    photo: null,
  });

  const pickImage = async () => {
    const result = await ImagePicker.launchImageLibraryAsync({
      mediaTypes: ImagePicker.MediaTypeOptions.Images,
      quality: 1,
    });

    if (!result.canceled) {
      setAnswers({ ...answers, photo: result.assets[0].uri });
    }
  };

  const validateStep2 = () => {
    if (!answers.loveAmt) {
      Alert.alert("Please tell me how much ü•∫");
      return;
    }
    setStep(3);
  };

  const generateReview = () => {
    if (!answers.comfort || !answers.food || !answers.activity) {
      Alert.alert("Please fill all details üíñ");
      return;
    }
    setStep("review");
  };

  return (
    <ScrollView contentContainerStyle={styles.container}>
      {step === 1 && (
        <View>
          <Image
            source={{ uri: "https://www.partysuppliesindia.com/cdn/shop/products/WINNETHEPOOHANDTIGERWITHOUTSIZE-21.jpg?v=1735567814" }}
            style={styles.sticker}
          />
          <Text style={styles.title}>Do you love me?</Text>
          <TouchableOpacity style={styles.btn} onPress={() => setStep(2)}>
            <Text style={styles.btnText}>Yes! ‚ù§Ô∏è</Text>
          </TouchableOpacity>
        </View>
      )}

      {step === 2 && (
        <View>
          <Text style={styles.title}>How much? ü•∫</Text>
          {[
            "A Lottt",
            "A lottttt moreee",
            "More than anything in this world",
            "You're my everything, mosttt!!",
          ].map((item) => (
            <TouchableOpacity
              key={item}
              style={styles.radio}
              onPress={() => setAnswers({ ...answers, loveAmt: item })}
            >
              <Text>{item}</Text>
            </TouchableOpacity>
          ))}
          <TouchableOpacity style={styles.btn} onPress={validateStep2}>
            <Text style={styles.btnText}>Next</Text>
          </TouchableOpacity>
        </View>
      )}

      {step === 3 && (
        <View>
          <Text style={styles.subtitle}>Quiz Time! #US</Text>
          <TextInput style={styles.input} placeholder="Our comfort spot?" onChangeText={(v) => setAnswers({ ...answers, comfort: v })} />
          <TextInput style={styles.input} placeholder="Go-to food place?" onChangeText={(v) => setAnswers({ ...answers, food: v })} />
          <TextInput style={styles.input} placeholder="Fav activity?" onChangeText={(v) => setAnswers({ ...answers, activity: v })} />
          <TextInput style={styles.textarea} multiline placeholder="Unforgettable memory?" onChangeText={(v) => setAnswers({ ...answers, memory: v })} />

          <TouchableOpacity style={styles.btn} onPress={pickImage}>
            <Text style={styles.btnText}>Pick Our Cutest Photo üì∏</Text>
          </TouchableOpacity>

          {answers.photo && <Image source={{ uri: answers.photo }} style={styles.preview} />}

          <TouchableOpacity style={styles.btn} onPress={generateReview}>
            <Text style={styles.btnText}>Done</Text>
          </TouchableOpacity>
        </View>
      )}

      {step === "review" && (
        <View>
          <Text style={styles.subtitle}>Your Answers ‚ú®</Text>
          <Text>Comfort Spot: {answers.comfort}</Text>
          <Text>Food Place: {answers.food}</Text>
          <Text>Fav Activity: {answers.activity}</Text>
          <Text>Memory: {answers.memory}</Text>

          <TouchableOpacity style={styles.btn} onPress={() => setStep(4)}>
            <Text style={styles.btnText}>Proceed...</Text>
          </TouchableOpacity>
        </View>
      )}

      {step === 4 && (
        <View>
          <Text style={styles.title}>WILL YOU BE MY VALENTINE? üåπ</Text>
          <TouchableOpacity style={styles.btn} onPress={() => setStep(5)}>
            <Text style={styles.btnText}>YES!</Text>
          </TouchableOpacity>
        </View>
      )}

      {step === 5 && (
        <View>
          <Text style={styles.title}>YAYYY! I Love You! üíñ</Text>
          {answers.photo && <Image source={{ uri: answers.photo }} style={styles.preview} />}
          <Text style={styles.paragraph}>
            I don‚Äôt just like you. I want my everyday to look like you.
          </Text>
        </View>
      )}
    </ScrollView>
  );
}

const styles = StyleSheet.create({
  container: {
    padding: 30,
    backgroundColor: "#ffdae0",
    flexGrow: 1,
    alignItems: "center",
  },
  title: {
    fontSize: 26,
    color: "#ff85a2",
    marginBottom: 20,
    textAlign: "center",
  },
  subtitle: {
    fontSize: 22,
    marginBottom: 15,
  },
  btn: {
    backgroundColor: "#ff9aa2",
    padding: 15,
    borderRadius: 30,
    marginVertical: 10,
  },
  btnText: {
    color: "white",
    fontSize: 16,
    textAlign: "center",
  },
  input: {
    borderWidth: 1,
    borderRadius: 10,
    padding: 12,
    marginVertical: 8,
    width: 280,
    backgroundColor: "#fff",
  },
  textarea: {
    height: 80,
    borderWidth: 1,
    borderRadius: 10,
    padding: 12,
    marginVertical: 8,
    backgroundColor: "#fff",
  },
  sticker: {
    width: 100,
    height: 100,
    alignSelf: "center",
    marginBottom: 10,
  },
  preview: {
    width: 250,
    height: 250,
    borderRadius: 15,
    marginVertical: 15,
  },
  radio: {
    backgroundColor: "#fbf7d5",
    padding: 15,
    borderRadius: 15,
    marginVertical: 5,
    width: 300,
  },
  paragraph: {
    marginTop: 20,
    fontSize: 16,
    textAlign: "center",
  },
});
